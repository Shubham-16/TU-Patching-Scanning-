survey_spec_body: {
    "name": "",
    "description": "",
    "spec": [
        {
            "question_name": "Scan Site Name",
            "question_description": "Select a site to be scanned on Rapid7 InsightVM",
            "required": true,
            "type": "multiplechoice",
            "variable": "scan_site_name",
            "min": null,
            "max": null,
            "default": "",
            "choices": "{{scan_sites_list}}"
        },
        {
            "question_name": "Scan Template",
            "question_description": "Select a scan template to be used",
            "required": true,
            "type": "multiplechoice",
            "variable": "scan_template",
            "min": null,
            "max": null,
            "default": "",
            "choices": "{{ scan_templates_list }}"
        },
        # {
        #     "question_name": "Hosts file name",
        #     "question_description": "Provide an hosts csv file name",
        #     "required": true,
        #     "type": "text",
        #     "variable": "csv_filename",
        #     "min": null,
        #     "max": null,
        #     "default": "",
        #     "choices": ""
        # },
        
        # {
        #     "question_name": "Scan Engine",
        #     "question_description": "Select a scan engine",
        #     "required": true,
        #     "type": "multiplechoice",
        #     "variable": "scan_engine_name",
        #     "min": null,
        #     "max": null,
        #     "default": "Local scan engine",
        #     "choices": "{{ scan_engines_list }}",
        #     "new_question": true
        # },
        {
            "question_name": "Scan Name",
            "question_description": "Provide a scan name",
            "required": true,
            "type": "text",
            "variable": "scan_name",
            "min": 0,
            "max": 1024,
            "default": "",
            "choices": "",
            "new_question": true
        },
        {
            "question_name": "IP Address",
            "question_description": "Provide a valid ipv4 address to scan within the site configuration
                                     example: ipv4_address1, ipv4_address2",
            "required": true,
            "type": "text",
            "variable": "ip_address",
            "min": 0,
            "max": 1024,
            "default": "",
            "choices": ""
        },
        {
            "question_name": "Scan Report Name",
            "question_description": "Provide a scan report name",
            "required": true,
            "type": "text",
            "variable": "scan_report_name",
            "min": 0,
            "max": 1008,
            "default": "",
            "choices":"",
            "new_question": true
        },
        {
            "question_name": "Sql Query",
            "question_description": "Provide a sql query to generate report ",
            "required": true,
            "type": "textarea",
            "variable": "sql_query",
            "min": 0,
            "max": 8008,
            "default": "WITH\n     vulnerability_cves AS (\n          SELECT vulnerability_id, array_to_string(array_agg(reference), ',') AS cves\n          FROM dim_vulnerability_reference\n          WHERE source = 'CVE'\n          GROUP BY vulnerability_id\n     ),\n     rolled_up_solutions AS (\n          SELECT asset_id, vulnerability_id, COALESCE(dss.superceding_solution_id, davs.solution_id) AS solution_id\n          FROM dim_asset_vulnerability_solution davs\n          LEFT OUTER JOIN dim_solution_supercedence dss USING (solution_id)\n     )\n\nSELECT ROUND(cvss_score::numeric, 1) AS \"CVSS Score\", severity AS Severity, das.name AS site,\n     da.ip_address AS \"IP Address\", da.host_name AS \"Host\",\n     dos.name AS \"OS\", dos.version AS \"OS Version\",\n     dv.title AS \"Vulnerability\", proofAsText(dv.description) AS \"Description\",\n     proofAsText(favi.proof) AS \"Proof\",\n     ds.summary AS \"Remediation\",\n     proofAsText(ds.fix) AS \"Steps\",\n     vcves.cves AS \"CVE\",\n     date_published AS \"Date Published\",  da.last_assessed_for_vulnerabilities AS \"Last Scanned\"\n\t\nFROM fact_asset_vulnerability_instance favi\n     JOIN dim_asset da USING (asset_id)\n\t JOIN dim_site_asset dss USING (asset_id)\n\t JOIN dim_site das USING (site_id)\n\t JOIN dim_operating_system dos USING (operating_system_id)\n     JOIN dim_vulnerability dv USING (vulnerability_id)\n     LEFT OUTER JOIN rolled_up_solutions sol USING (asset_id, vulnerability_id)\n     LEFT OUTER JOIN dim_solution ds USING (solution_id)\n     LEFT OUTER JOIN vulnerability_cves vcves USING (vulnerability_id)",
            "choices":"",
            "new_question": true
        }
    ]
}

scan_sites_list: []
scan_templates_list: []
scan_engines_list: []